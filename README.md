# ロボ研報告書作成ツールの使い方

このプロジェクトは、Flask ベースの Web アプリケーションで、アップロードされた ZIP アーカイブ内の Word 文書（`.doc` / `.docx`）を PDF に変換し、結合した後に指定した宛先へメール送信します。報告書作成の手間を削減することを目的としています。

運用は Microsoft Word が利用できる **Windows 環境限定** です。

## 主な機能

- ZIP アーカイブをアップロードすると、含まれる Word 文書を自動的に展開します。
- Web UI 上で PDF に結合する順番を調整できます。
- 変換・結合・メール送信をバックグラウンドで処理します。
- デフォルトの発表順リスト編集機能、ソート機能があります。
- 結合後のPDFファイルはダウンロードにも対応しています。(ダウンロードは処理完了後10分間有効)

## 必要環境

- Windows 10 以降（Microsoft Word がインストールされていること）
- Python 3.10 以上

## セットアップ手順

1. 依存パッケージをインストールします。
   ```bash
   pip install -r requirements.txt
   ```

2. アプリケーションを起動します。
   ```bash
   python tray_launcher.py
   ```
3. ブラウザで `http://127.0.0.1`または`localhost` にアクセスすると、アップロード画面が表示されます。

### PyInstaller によるトレイランチャー付きバンドル

Windows 向けに PyInstaller を用いて実行ファイルを作成する場合は、
`tray_launcher.py` をエントリーポイントとして利用してください。既定の
`.spec` ファイルはトレイランチャーを起動するよう更新されているため、
以下のコマンドでビルドできます。

```bash
pyinstaller report_pdf_converter.spec --noconfirm --clean
```

生成された `ReportPDFConverter.exe` はシステムトレイアイコンを常駐させ、
Web アプリケーションの起動・停止・ブラウザ表示を制御します。
この実行ファイルと同じディレクトリにorder.jsonを置いてください。デフォルトのソート順が使用可能です。

## 使い方

1. Word 文書（`.doc` / `.docx`）を 1 つにまとめたZIP ファイルを用意します。(ロボ班サーバーNext Cloudからダウンロードできる)
2. Web アプリにアクセスし、ZIP ファイルをアップロードします。
3. 必要に応じて、PDF に結合する順番を UI で並び替えます。
4. 変換が完了すると、結合された PDF がダウンロードできます。
