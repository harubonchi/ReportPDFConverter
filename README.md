# ロボ研報告書作成ツールの使い方

このプロジェクトは、Flask ベースの Web アプリケーションで、アップロードされた ZIP アーカイブ内の Word 文書（`.doc` / `.docx`）を PDF に変換し、結合した後に指定した宛先へメール送信します。報告書作成の手間を削減することを目的としています。

## 主な機能

- ZIP アーカイブをアップロードすると、含まれる Word 文書を自動的に展開します。
- Web UI 上で PDF に結合する順番を調整できます。
- 変換・結合・メール送信をバックグラウンドで処理します。
- デフォルトの発表順リスト編集機能、ソート機能があります。
- 結合後のPDFファイルはダウンロードにも対応しています。(ダウンロードは処理完了後10分間有効)

## 必要環境

- Python 3.10 以上
- PDF 変換・メール送信用にインターネット接続
- SMTP サーバーの認証情報（メール送信に使用）

## セットアップ手順

1. 依存パッケージをインストールします。
   ```bash
   pip install -r requirements.txt
   ```
2. 環境変数を設定します。「環境変数の設定」項目に記述している内容をテキストファイルにコピペし、メールサーバの認証情報を設定したら.env(拡張子なし)というファイル名で保存してください。.envファイルはapp.pyと同じディレクトリに配置してください。

3. アプリケーションを起動します。
   ```bash
   python app.py
   ```
4. ブラウザで `http://localhost:5000` にアクセスすると、アップロード画面が表示されます。

## 環境変数の設定

以下の変数は必須です。`.env` に追記するか、実行環境に直接設定してください。

```
EMAIL_SENDER=example@example.com
EMAIL_USERNAME=example@example.com
EMAIL_PASSWORD=your-password
EMAIL_SMTP_SERVER=smtp.example.com
EMAIL_SMTP_PORT=587
EMAIL_USE_TLS=true
```

> **注意**: `.env` には個人情報が含まれます。リポジトリにコミットしたり共有したりしないようご注意ください。

## 使い方

1. Word 文書（`.doc` / `.docx`）を 1 つの ZIP ファイルにまとめます。
2. Web アプリにアクセスし、ZIP ファイルをアップロードします。
3. 必要に応じて、PDF に結合する順番を UI で並び替えます。
4. 受信者のメールアドレスを入力し、送信ボタンを押します。
5. 変換が完了すると、結合された PDF が添付されたメールが送信されます。

## トラブルシューティングとヒント

- メールが届かない場合は、SMTP サーバー情報・ユーザー名・パスワード・ポート番号・TLS 設定が正しいか確認してください。
- 大きなファイルや大量の文書を扱う場合、変換処理に時間がかかることがあります。ブラウザを閉じずに完了までお待ちください。
- ログはコンソールに出力されます。問題が発生した場合は、ターミナル出力を確認してください。

## セキュリティに関する注意

- `.env` ファイルは開発者個人の環境で管理し、外部に共有しないでください。
- アップロードされたファイルは処理後に削除されますが、不要なファイルが残っていないか定期的に確認してください。
