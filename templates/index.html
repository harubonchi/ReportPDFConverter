<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Gain Report Emailer</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 2rem auto;
        max-width: 720px;
        line-height: 1.5;
        color: #1f2933;
      }
      h1 {
        color: #0b7285;
      }
      form {
        border: 1px solid #cbd5e1;
        border-radius: 8px;
        padding: 1.5rem;
        background: #f8fafc;
        margin-top: 1.5rem;
      }
      label {
        display: block;
        margin-bottom: 0.5rem;
        font-weight: bold;
      }
      input[type="email"],
      input[type="file"] {
        width: 100%;
        padding: 0.5rem;
        margin-bottom: 1rem;
        border: 1px solid #cbd5e1;
        border-radius: 4px;
      }
      button {
        background-color: #0b7285;
        border: none;
        color: white;
        padding: 0.6rem 1.2rem;
        text-align: center;
        font-size: 1rem;
        border-radius: 4px;
        cursor: pointer;
      }
      button:hover {
        background-color: #0c8599;
      }
      .flash {
        background: #ffe066;
        padding: 0.75rem 1rem;
        border-radius: 4px;
        margin-bottom: 1rem;
      }
      .order-list {
        margin-top: 1.5rem;
        padding: 1rem;
        border: 1px dashed #94a3b8;
        border-radius: 8px;
        background-color: #fff;
      }
      .order-list h2 {
        margin-top: 0;
      }
      .order-list ul {
        padding-left: 1.25rem;
      }
      .hint {
        background: #e7f5ff;
        border-left: 4px solid #0b7285;
        padding: 0.75rem 1rem;
        border-radius: 4px;
        margin-top: 1rem;
      }
    </style>
  </head>
  <body>
    <h1>Generate and Email Merged Reports</h1>
    <p>
      Upload a ZIP archive containing Word documents. After selecting the order, the
      system will convert the documents to PDF, merge them, and email the final PDF to
      the specified address.
    </p>
    <p class="hint">
      When the ZIP archive includes team folders (such as R班, N班, or S班), the documents will be
      automatically labelled with their team so you can organise them more easily when arranging the order.
    </p>

    {% with messages = get_flashed_messages() %}
      {% if messages %}
        {% for message in messages %}
          <div class="flash">{{ message }}</div>
        {% endfor %}
      {% endif %}
    {% endwith %}

    <form action="{{ url_for('prepare_upload') }}" method="post" enctype="multipart/form-data">
      <label for="email">Recipient email address</label>
      <input type="email" name="email" id="email" required placeholder="name@example.com" />

      <label for="zip_file">ZIP file containing Word documents</label>
      <input type="file" name="zip_file" id="zip_file" accept=".zip" required />

      <button type="submit">Upload and choose order</button>
    </form>

    {% if saved_order %}
      <div class="order-list">
        <h2>Most recent document order</h2>
        <ul>
          {% for item in saved_order %}
            <li>{{ item }}</li>
          {% endfor %}
        </ul>
      </div>
    {% endif %}
  </body>
</html>